#define MASK_7 0x7F

void unpack(unsigned int *p, unsigned int *w, int BS)
{
  int i;
  for (i = 0; i < BS; i+=32, p+=32, w+=7)
    {
      p[0] = (w[0] >> 25);
      p[1] = (w[0] >> 18) & 127;
      p[2] = (w[0] >> 11) & 127;
      p[3] = (w[0] >> 4) & 127;
      p[4] = (w[0] << 3) & 127;
      p[4] |= (w[1] >> 29);
      p[5] = (w[1] >> 22) & 127;
      p[6] = (w[1] >> 15) & 127;
      p[7] = (w[1] >> 8) & 127;
      p[8] = (w[1] >> 1) & 127;
      p[9] = (w[1] << 6) & 127;
      p[9] |= (w[2] >> 26);
      p[10] = (w[2] >> 19) & 127;
      p[11] = (w[2] >> 12) & 127;
      p[12] = (w[2] >> 5) & 127;
      p[13] = (w[2] << 2) & 127;
      p[13] |= (w[3] >> 30);
      p[14] = (w[3] >> 23) & 127;
      p[15] = (w[3] >> 16) & 127;
      p[16] = (w[3] >> 9) & 127;
      p[17] = (w[3] >> 2) & 127;
      p[18] = (w[3] << 5) & 127;
      p[18] |= (w[4] >> 27);
      p[19] = (w[4] >> 20) & 127;
      p[20] = (w[4] >> 13) & 127;
      p[21] = (w[4] >> 6) & 127;
      p[22] = (w[4] << 1) & 127;
      p[22] |= (w[5] >> 31);
      p[23] = (w[5] >> 24) & 127;
      p[24] = (w[5] >> 17) & 127;
      p[25] = (w[5] >> 10) & 127;
      p[26] = (w[5] >> 3) & 127;
      p[27] = (w[5] << 4) & 127;
      p[27] |= (w[6] >> 28);
      p[28] = (w[6] >> 21) & 127;
      p[29] = (w[6] >> 14) & 127;
      p[30] = (w[6] >> 7) & 127;
      p[31] = (w[6]) & 127;
    }
}
